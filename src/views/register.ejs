<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.1/css/all.css" crossorigin="anonymous" />
  <link rel="stylesheet" href="/styles/general.css">
  <link rel="stylesheet" href="/styles/register.css" />
  <title>ToyHub - Register</title>
</head>

<body>
  
  <%- include('./partials/header.ejs') %>

  <main class="main main-register">
    <form class="register" action="/user/register" method="POST" enctype="multipart/form-data">
      <h1>REGISTRATE <i class="fa-solid fa-right-to-bracket fa-xl"></i></h1>
      <p>¡Compra con mas seguridad y lleva el control de tus pedidos!</p>
      <div class="form-register">
        <div class="form-group">
          <input type="text" id="name" name="name" value="<%= ( locals.old && old.name ) ? old.name : '' %>"/>
          <label for="name">Nombre</label>
          <% if( locals.errors && errors.name ){ %>
            <p> <%= errors.name.msg %> </p>
        <% } %>
        </div>
        <div class="form-group">
          <input type="text" id="lastname" name="lastname"  value="<%= ( locals.old && old.lastname ) ? old.lastname : '' %>"/>
          <label for="lastname">Apellido</label>
          <% if( locals.errors && errors.lastname ){ %>
            <p> <%= errors.lastname.msg %> </p>
        <% } %>
        </div>
        <div class="form-group">
          <input type="email" id="email" name="email" value="<%= ( locals.old && old.email ) ? old.email : '' %>" />
          <label for="email">Email</label>
          <% if( locals.errors && errors.email ){ %>
            <p> <%= errors.email.msg %> </p>
        <% } %>
        </div>
        <div class="form-group custom-file-input">
          <label class="form-group-image" for="photo">
            <div class="image-preview">
              <img src="/images/default-user.jpg" alt="Foto de perfil" />
            </div>
            <i class="fa-solid fa-arrow-up-from-bracket fa-xl"></i><br>
            <span>Seleccionar Foto de perfil</span>
          </label>
          <input type="file" id="photo" name="photo" accept="image/*" >
          <% if( locals.errors && errors.photo){ %>
            <p> <%= errors.photo.msg %> </p>
        <% } %>
        </div>
        <div class="form-group">
          <input type="number" id="telephone" name="telephone" />
          <label for="telephone">Telefono(opcional)</label>
        </div>
        
        <div class="form-group">
          <input type="password" id="password" name="password"  value="<%= ( locals.old && old.password ) ? old.password : '' %>"/>
          <label for="password">Contraseña</label>
          <% if( locals.errors && errors.password ){ %>
            <p> <%= errors.password.msg %> </p>
        <% } %>
        </div>
        
        <div class="form-group">
          <input type="password" id="confirm_password" name="confirm_password" value="<%= ( locals.old && old.confirm_password ) ? old.confirm_password : '' %>" />
          <label for="confirm_password">Confirmar Contraseña</label>
          <% if( locals.errors && errors.confirm_password ){ %>
            <p> <%= errors.confirm_password.msg %> </p>
        <% } %>
        </div>
      </div>
      <input type="submit" value="Crear cuenta" />
    </form>
  </main>
  <%- include('./partials/footer.ejs') %>
</body>
<script>
  const photoProfileUser = document.getElementById('photo');
  const imagePreview = document.querySelector('.image-preview img');

  photoProfileUser.addEventListener('change', () => {
    const file = photoProfileUser.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        imagePreview.src = e.target.result;
      }
      reader.readAsDataURL(file);
    }else{
      imagePreview.src = '/images/default-user.jpg';
    }
  });
</script>

</html>